/*! Build time : Mon Sep 21 2020 21:58:01 GMT+0800 (香港标准时间) */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["dsf-mobile"],{"059d":function(t,e,a){"use strict";var n=a("d318"),i=a.n(n);i.a},1734:function(t,e,a){"use strict";var n=function(t,e){var a=e._c;return a("div",{staticClass:"ds-grid-layout mobile",style:e.$options.getStyle(e)},[e._l(e.props.areas,(function(t,n){var i=t.name,s=t.colspan,o=t.rowspan,r=t.startColIndex,l=t.startRowIndex,c=t.index;return[a("div",{key:i,ref:"gridAreas",refInFor:!0,class:["grid-area",i],style:{"grid-area":i,"min-height":e.$options.getRowHeight(e,l,r,s,o)},attrs:{index:n,"grid-index":c,"row-index":l,"col-index":r,colspan:s,rowspan:o}},[e._t(i)],2)]})),e.props.isDesign?[e._l(e.props.gridTemplate,(function(t,e){return[a("div",{key:"-"+e,class:["grid-area","e-"+e],style:{"grid-area":"e-"+e,border:"none"}})]}))]:e._e()],2)},i=[],s=a("32e2"),o=s["a"],r=a("2877"),l=Object(r["a"])(o,n,i,!0,null,null,null);e["a"]=l.exports},"1edb":function(t,e,a){},"32e2":function(t,e,a){"use strict";(function(t){a("a15b"),a("d81d");e["a"]={name:"DsfMobileDataGridItemLayout",props:{isDesign:{type:Boolean,default:!1},gridTemplate:{type:Array,default:function(){return[]}},gridColumns:{type:Array,default:function(){return[]}},gridRows:{type:Array,default:function(){return[]}},areas:{type:Array,default:function(){return[]}}},getTemplate:function(e){var a=e.props.gridTemplate;return t.map(a,(function(t,a){var n="";return e.props.isDesign&&(n=" e-"+a),"'grid-area-"+t.join(" grid-area-")+n+"'"})).join(" ")},getStyle:function(e){var a=e.props.gridColumns,n=e.props.gridRows;e.props.isDesign&&(a=JSON.parse(JSON.stringify(a)),a.push("0"));var i={height:"100%","grid-template-columns":t.map(a,(function(t){return dsf.pxToRem(t)})).join(" "),"grid-template-areas":e.$options.getTemplate(e)};return!e.parent.isDesign&&n.length&&(i["grid-template-rows"]=t.map(n,(function(t){return dsf.pxToRem(t)})).join(" ")),i},getRowHeight:function(t,e,a,n,i){return t.parent.isDesign?n>1&&i>1?"auto":dsf.pxToRem(t.props.gridRows[e]):"auto"}}}).call(this,a("2ef0"))},"482c":function(t,e,a){"use strict";(function(t){a("c740");e["a"]={name:"DsfMobileButtonNav",ctrlCaption:"自定义组件",props:{buttons:{type:Array,default:function(){return[{name:"首页",route:"index",fonticon:"shouyeweixuanzhong",activefonticon:"shouyexuanzhong",icon:{active:"https://img.yzcdn.cn/vant/user-active.png",inactive:"https://img.yzcdn.cn/vant/user-inactive.png"}}]}}},data:function(){return{active:0}},computed:{},watch:{$route:function(t){1===t.meta.level&&this.setActive(t.path)}},beforeCreate:function(){},created:function(){},beforeMount:function(){},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},methods:{setActive:function(e){var a=t.findIndex(this.buttons,(function(t){return t.url===e}));a>=0&&(this.active=a)},go:function(t){this.$route.path!==t&&this.$router.push({path:t})}}}}).call(this,a("2ef0"))},7958:function(t,e,a){"use strict";(function(t){a("99af"),a("b0c0"),a("a9e3"),a("acd8"),a("e25e"),a("ac1f"),a("1276"),a("4795");var n=a("2909"),i=a("3e29");e["a"]=dsf.component({name:"DsfMobilePage",ctrlCaption:"移动端页面",mixins:[i["a"]],data:function(){return{gotoIcon:dsf.config.designer.gotoIcon,headHeight:0,footHeight:0,centerHeight:"auto",headerStyle:{},footerStyle:{},leftAndRIghtStyle:{},containerHeight:0,containerWidth:0}},props:{formItemLabelWidth:{type:Number,default:120},slots:{type:Array,default:function(){return[{name:"center",controls:[]},{name:"head",controls:[]},{name:"foot",controls:[]}]}},pageLevel:{type:Number,default:1},isKeepAlive:{type:Boolean,default:!1}},beforeCreate:function(){},computed:{leftViewWidth:function(){var t=this.viewSplit.split(","),e=t[0]?parseInt(t[0]):0;return e},rightViewWidth:function(){var t=this.viewSplit.split(","),e=t[1]?parseInt(t[1]):0;return e},leftViewShow:function(){var t=parseFloat(this.leftViewWidth);return 0!=t},rightViewShow:function(){var t=parseFloat(this.rightViewWidth);return 0!=t},splitWidth:function(){return"split-small"==this.leftRight?5:"split-medium"==this.leftRight?10:"split-big"==this.leftRight?15:0},splitWidthHorizontal:function(){return"split-small"==this.topBottom?5:"split-medium"==this.topBottom?10:"split-big"==this.topBottom?15:0},getCss:function(){return[].concat(Object(n["a"])(this.$getClass()),["1"===this.fit||!0===this.fit?"fit":""])},pageStyle:function(){var t=this.headHeight,e=this.footHeight;return this.isDesign||(t+=this.splitWidthHorizontal,e+=this.splitWidthHorizontal),{"padding-top":t+"px","padding-bottom":e+"px"}},pageContentStyle:function(){var t=this.leftViewWidth,e=this.rightViewWidth;return this.isDesign||(t=t>0?t+this.splitWidth:0,e=e>0?e+this.splitWidth:0),{"padding-left":t+"px","padding-right":e+"px",width:this.isDesign?"auto":"100%"!=this.pageWidth&&this.pageWidth?this.pageWidth:"auto",margin:"auto"}},leftStyle:function(){this.headHeight,this.footHeight;var t=this.leftViewWidth;return{width:t+"px",bottom:"0px",top:"0px",left:"0px"}},rightStyle:function(){this.headHeight,this.footHeight;var t=this.rightViewWidth;return{width:t+"px",bottom:"0px",top:"0px",right:"0px"}}},created:function(){},destroyed:function(){},beforeDestroy:function(){this.$refs.eleDesgin&&this.$refs.eleDesgin.parentNode&&this.$refs.eleDesgin.parentNode.removeChild(this.$refs.eleDesgin)},mounted:function(){this.isDesign&&(this.watchCenterHeight(),this.resize()),this.$refs.eleDesgin&&document.body.append(this.$refs.eleDesgin)},updated:function(){},methods:{watchCenterHeight:function(){this.setCenterHeight(),window.setTimeout(this.watchCenterHeight,1e3)},setCenterHeight:function(){var e=this.$refs.head?this.$refs.head:null,a=this.$refs.foot?this.$refs.foot:null;this.headHeight=e?t(e).outerHeight():0,this.footHeight=a?t(a).outerHeight():0},setleftAndRightStyle:function(){if(this.$el){var t={},e=this.containerHeight-this.headHeight-this.footHeight;t.height=e+"px",t["margin-top"]=this.headHeight+"px",this.leftAndRIghtStyle=t}},setContainerSize:function(){if(this.$el){var e=t(this.$el.parentNode);this.containerHeight=e.innerHeight(),this.containerWidth=e.innerWidth()}},resize:function(){this.setContainerSize(),this.setCenterHeight()},gotoPreview:function(){var t=this.$refs.eleDesgin.getAttribute("data-flag");if("true"===t){var e="".concat(dsf.url.getWebPath("~/designer.html#/mobile/page?B="+this.context.B+"&M="+this.context.M+"&pname="+this.name+"&title="+this.title));window.open(e)}}},directives:{drag:{inserted:function(t){t.onmousedown=function(e){t.setAttribute("data-flag",!1);var a=e.clientX-t.offsetLeft,n=e.clientY-t.offsetTop;document.onmousemove=function(e){t.style.left=e.clientX-a+"px",t.style.top=e.clientY-n+"px"};var i=(new Date).getTime();document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null;var a=(new Date).getTime();a-i<200&&t.setAttribute("data-flag",!0)}}}}}})}).call(this,a("1157"))},"7b7c":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("323e"),i=a.n(n),s=(a("a5d8"),a("2cd9"),a("b9f7"),a("32a4"),a("7a9c"),a("b1ac")),o=a("a4f6"),r=a("463c"),l=a("ccef"),c=a("022c"),u=(a("1edb"),["/mobile/test/wengtest/mobiletest001","/mobile/test/wengtest/mobiletest002"]),d=u,f=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("div",{staticClass:"mobile-view"},[[a("div",{staticClass:"mobile-view-content",class:{"has-foot":1==t.$route.meta.level}},[a("transition",{attrs:{name:t.transitionName}},[a("keep-alive",{attrs:{include:t.cachePages}},[a("router-view",{staticClass:"full-view",on:{inited:t.viewInited}})],1)],1)],1),a("div",{staticClass:"mobile-view-foot"},[a("transition",{attrs:{name:t.transitionName}},[1==t.$route.meta.level?a("div",{key:"nav-bar",staticClass:"mobile-view-nav-bar"},[a("DsfMobileButtonNav",{attrs:{buttons:t.navs}})],1):a("div",{key:"nav-bar-opacity",staticClass:"mobile-view-nav-bar-opacity"})])],1)]],2)])},h=[],p=(a("b0c0"),{provide:function(){return{$isMobile:!0}},data:function(){return{themes:dsf.config.defaultTheme,transitionName:"",controlName:"router-view",cachePages:[],navs:[{url:"/mobile/test/wengtest/mobiletest001",text:"页面1",icon:{general:"shouyeweixuanzhong",active:"shouyexuanzhong"}},{url:"/mobile/test/wengtest/mobiletest002",text:"页面2",icon:{general:"zaixueweixuanzhong",active:"zaixuexuanzhong"}},{url:"/mobile/test/wengtest/mobiletest003",text:"页面3",icon:{general:"",active:""}}]}},watch:{$route:{handler:function(t,e){t||!e||1==t.meta.level&&t.meta.level==e.meta.level?this.transitionName="":this.transitionName=window.$$state.pageDirection},immediate:!0}},beforeCreate:function(){},mounted:function(){document.body.classList.add(this.themes)},methods:{viewInited:function(t){!0===t.$keepAlive&&dsf.array.ensure(this.cachePages,t.$options.name)}}}),g=p,m=(a("059d"),a("2877")),v=Object(m["a"])(g,f,h,!1,null,"1998e0f6",null),w=v.exports,y=a("517e"),x=(a("99af"),a("2909")),b=a("a026"),C=a("8c4f"),D=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._v(" 404 ")])},_=[],k={name:"Error"},I=k,S=Object(m["a"])(I,D,_,!1,null,null,null),$=S.exports,N=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"box-wrap staff-vavate-manage-wrap top"},[a("wf-process",{ref:"wfProcess"}),a("div",{staticClass:"btn-area"},[a("div",{staticClass:"disagree-btn",on:{click:t.getSendBackLink}},[t._v("退回")]),a("div",{staticClass:"agree-btn",on:{click:t.sendAction}},[t._v("发送")])]),a("van-dialog",{staticClass:"staffAdviseDialog",attrs:{title:"审批意见","show-cancel-button":"","confirm-button-text":"发送"},on:{confirm:t.onConfirm},model:{value:t.showDialog,callback:function(e){t.showDialog=e},expression:"showDialog"}},[a("van-field",{attrs:{placeholder:t.dialogHolder,border:!0,rows:"4",autosize:"",type:"textarea"},model:{value:t.shyj_value,callback:function(e){t.shyj_value=e},expression:"shyj_value"}})],1)],1),a("wf-last-node",{ref:"wfLastNode"}),a("wf-choose-links",{ref:"wfChooseLinks"}),a("wf-choose-users",{ref:"wfChooseUsers"}),a("wf-Opinion",{ref:"wfOpinion"})],1)},O=[],T=a("5530"),j=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-dialog",{staticClass:"work_flow",attrs:{title:t.title||"流程已发送到以下人员","before-close":t.beforeClose,"confirm-button-text":"返回列表"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[!t.title&&t.data.Links?a("div",{staticClass:"userbox"},[t._l(t.data.Links.filter((function(t){return 0==t.Status&&t.LinkUser})),(function(e){return[a("span",{key:e.id},[t._v(t._s(t.getUser(e)))])]}))],2):t._e()])},L=[],R={name:"LastNodeDialog",data:function(){return{data:{},show:!1,title:null,resolve:function(){}}},methods:{showFun:function(t,e){this.data=t||{},20004==this.data.Code||20005==this.data.Code?this.title="流程已办结":this.title=null,this.show=!0,e&&(this.resolve=e)},getUser:function(t){var e=t.LinkUser,a=e.Type,n="";return 1==a?n=e.UserName:2==a?n=e.DeptName+"-"+e.RoleName:3==a?n=e.JobName:4==a&&(n=e.UserName+"-"+e.RelationName),n},beforeClose:function(t,e){e(),this.resolve()}}},P=R,W=Object(m["a"])(P,j,L,!1,null,null,null),H=W.exports,M=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-dialog",{staticClass:"work_flow-linksDialog",attrs:{"show-cancel-button":"","before-close":t.beforeClose,title:"请选择要发送的环节"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("van-picker",{ref:"picker",attrs:{columns:t.data,"value-key":"Name",title:"标题"}})],1)},A=[],F={name:"ChooseLinksDialog",data:function(){return{data:{},show:!1,title:null,resolve:function(){}}},methods:{showFun:function(t,e){this.data=t.SendParams&&t.SendParams.Lines||{},this.show=!0,e&&(this.resolve=e)},beforeClose:function(t,e){"cancel"!==t?(e(!1),this.resolve(this.$refs.picker.getValues()[0])):e()}}},E=F,J=Object(m["a"])(E,M,A,!1,null,null,null),q=J.exports,V=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-popup",{staticClass:"work_flow-usersDialog",style:{height:"100%"},attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[n("div",{staticClass:"header"},[t._v("请选择人员")]),n("div",{staticClass:"content"},[n("div",{staticClass:"txt"},[n("van-field",{attrs:{rows:"2",autosize:"",type:"textarea",placeholder:"请输入审批意见"},model:{value:t.message,callback:function(e){t.message=e},expression:"message"}})],1),t.tpls.length>0?n("div",{staticClass:"template"},[n("div",t._l(t.tpls,(function(e,a){return n("span",{key:a,on:{click:function(a){t.message=e.key_word}}},[t._v(t._s(e.key_word))])})),0)]):t._e(),n("div",{staticClass:"funs"},[n("i",{staticClass:"iconfont icon-cloud-upload",on:{click:function(e){return t.uploader(0)}}}),n("i",{staticClass:"iconfont icon-charutupian",on:{click:function(e){return t.uploader(1)}}})]),n("van-uploader",{ref:"uploader",class:{no:0==t.uploaderData.length},attrs:{"max-count":9,multiple:"","after-read":t.uploaderAfterRead,accept:t.acceptsType},on:{"click-preview":t.preview},model:{value:t.uploaderData,callback:function(e){t.uploaderData=e},expression:"uploaderData"}}),n("van-popup",{style:{height:"80%",width:"100%"},model:{value:t.previewing,callback:function(e){t.previewing=e},expression:"previewing"}},[n("div",[t.previewing?n("dsf-iframe",{attrs:{src:t.filePath}}):t._e()],1)]),n("div",{staticClass:"users"},[n("p",[t._v("您即将发给：")]),t._l(t.data.filter((function(t){return t.users.length>0})),(function(e){return n("div",{key:e.id,staticClass:"dept",class:{noSeletc:!Object.keys(e.selects).length}},[n("div",{staticClass:"desc"},[n("div",{staticClass:"title"},[t._v(t._s(t.getLinkName(e.name)))]),n("div",{staticClass:"num"},[t._v(t._s((1==e.users.length?"1":Object.keys(e.selects).length)||0)+"人审核")])]),n("div",{staticClass:"imgs"},t._l(e.users,(function(i,s){return n("div",{key:i.ID,class:{noSeletc:!i.isSelect},on:{click:function(a){return t.changeUser(i,s,e)}}},[n("van-image",{attrs:{round:"",width:"40px",height:"40px",fit:"cover",src:"/oua/getRedisUserPhoto?userId="+i.ID},scopedSlots:t._u([{key:"loading",fn:function(){return[n("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0},{key:"error",fn:function(){return[n("img",{staticClass:"header",attrs:{src:a("6764")}})]},proxy:!0}],null,!0)}),i.isSelect?n("van-icon",{attrs:{name:"checked"}}):t._e(),n("span",[t._v(t._s(i.Name))])],1)})),0)])}))],2)],1),n("div",{staticClass:"footer"},[n("div",{on:{click:function(e){t.show=!1}}},[t._v("暂不发送")]),n("div",{on:{click:t.submit}},[t._v("发送")])])])},z=[],B=a("82d7"),U=B["a"],K=Object(m["a"])(U,V,z,!1,null,null,null),G=K.exports,X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"work_flow-process"},t._l(t.flowProcess,(function(e){return n("div",{key:e.linkid,staticClass:"item",class:{"no-user":!e.rusername}},[n("van-image",{attrs:{round:"",width:"40px",height:"40px",fit:"cover",src:"/oua/getRedisUserPhoto?userId="+e.ruserid},scopedSlots:t._u([{key:"loading",fn:function(){return[n("van-loading",{attrs:{type:"spinner",size:"20"}})]},proxy:!0},{key:"error",fn:function(){return[n("img",{staticClass:"header",attrs:{src:a("6764")}})]},proxy:!0}],null,!0)}),n("van-image",{staticClass:"icon",attrs:{round:"",fit:"cover",src:t.getStateImg(e)}}),n("div",{staticClass:"des"},[n("p",{staticClass:"first-child"},[n("span",{staticClass:"title"},[t._v(t._s(e.nodename))]),n("span",{staticClass:"time"},[t._v(t._s(t.format(e.reachtime)))])]),e.rusername?n("p",{staticClass:"name"},[t._v(t._s(e.rusername))]):t._e(),t.getIdea(e)?n("p",{staticClass:"yj"},[t._v(t._s(t.getIdea(e)))]):t._e(),n("p",{staticClass:"files"},[n("van-grid",{attrs:{"column-num":3,border:!1}},t._l(t.getFiles(e),(function(e,a){return n("van-grid-item",{key:a,attrs:{icon:t.getType(e),text:e.originalFileName},on:{click:function(a){return t.preview(e)}}})})),1)],1)]),n("van-popup",{style:{height:"80%",width:"100%"},model:{value:t.previewing,callback:function(e){t.previewing=e},expression:"previewing"}},[n("div",[t.previewing?n("dsf-iframe",{attrs:{src:t.filePath}}):t._e()],1)]),n("van-image-preview",{attrs:{images:t.images},model:{value:t.showImg,callback:function(e){t.showImg=e},expression:"showImg"}})],1)})),0)},Y=[],Q=(a("fb6a"),{name:"FlowProcess",data:function(){return{flowProcess:[],previewing:!1,filePath:"",images:[],showImg:!1}},methods:{setData:function(t){this.flowProcess=t},getStateImg:function(t){var e=t.STATUS;return"-31"==e?e="-3":"-1"==e&&(e="-2"),e||0===e?a("5fdb")("./status".concat(e,".png")):null},getIdea:function(t){return t.opinionatts?JSON.parse(t.opinionatts).Content:null},getFiles:function(t){return t.opinionatts?JSON.parse(t.opinionatts).Attachments:null},format:function(t){return t?dsf.date.format(t,"mm-dd hh:ii"):""},getType:function(t){return"image"===t.contentType.slice(0,5)?"photo-o":"orders-o"},preview:function(t){t&&t.contentType&&"image"!==t.contentType.slice(0,5)?(this.filePath=dsf.config.webRoot+"preview/file?fileId="+t.id,this.previewing=!0):(this.images=[dsf.config.webRoot+t.relativePath],this.showImg=!0)}}}),Z=Q,tt=Object(m["a"])(Z,X,Y,!1,null,null,null),et=tt.exports,at=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-popup",{staticClass:"work_flow-usersDialog work_flow-opiDialog",style:{height:"100%"},attrs:{position:"bottom"},model:{value:t.show,callback:function(e){t.show=e},expression:"show"}},[a("div",{staticClass:"header"},[t._v(t._s(t.typeText[t.type]["title"]))]),a("div",{ref:"content",staticClass:"content"},[t.h?a("van-field",{ref:"reason",attrs:{rows:"1",autosize:{minHeight:t.h},type:"textarea",placeholder:"请输入"+t.typeText[t.type]["title"]},model:{value:t.msg,callback:function(e){t.msg=e},expression:"msg"}}):t._e()],1),a("div",{staticClass:"footer"},[a("div",{on:{click:function(e){t.show=!1}}},[t._v("暂不"+t._s(t.typeText[t.type]["type"]))]),a("div",{on:{click:t.submitFun}},[t._v(t._s(t.typeText[t.type]["type"]))])])])},nt=[],it={name:"OpinionDialog",data:function(){return{h:0,msg:"",type:0,show:!1,typeText:[{title:"退回理由",type:"退回"},{title:"审核意见",type:"发送"}],resolve:function(){}}},created:function(){},methods:{showFun:function(t,e){var a=this;this.type=t>0?t:0,this.msg="",this.show=!0,e&&(this.resolve=e),this.$nextTick((function(){a.h=a.$refs.content.offsetHeight-20}))},submitFun:function(){this.msg?this.resolve(this.msg):dsf.layer.message("请输入"+this.typeText[this.type]["title"],!1)}}},st=it,ot=Object(m["a"])(st,at,nt,!1,null,null,null),rt=ot.exports,lt={components:{wfLastNode:H,wfChooseLinks:q,wfChooseUsers:G,wfProcess:et,wfOpinion:rt},data:function(){return{sWFID:"",sObjectID:"",sObjectName:"",sPID:"",sCurLinkID:"",requestID:null,loader:null,processInfo:[]}},methods:{loading:function(t){this.loader||(this.loader=dsf.layer.loading(t||"发送中"))},closeLoading:function(t){dsf.layer.closeLoading(this.loader),this.loader=null,t&&dsf.layer.message(t,!1)},sendAction:function(){var t=this;if(this.sWFID){this.loading();var e="",a={};this.sPID?(e="wfr/send",a={sPID:this.sPID,sCurLinkID:this.sCurLinkID,sExInfos:""}):(e="wfr/startSend",a={sWFID:this.sWFID,sObjectID:this.sObjectID,sObjectName:this.sObjectName,sCurNodeID:"",sExInfos:""}),a.sOpinion=JSON.stringify({Content:"",Attachments:[]}),this.requestID=null,dsf.http.post(e,a).then((function(e){2e4==e.data.state&&e.data.data.RequestID?t.wFType(e,[]):dsf.layer.message("发送异常：".concat(e.data.message))})).catch((function(t){dsf.layer.message("".concat(e,"，服务器异常"))}))}},wFType:function(t,e){var a=this;if(2e4==t.data.state){var n=t.data.data,i=n.Code;if(this.requestID=n.RequestID,2e4==i||20004==i||20005==i){for(var s in e)e[s].show=!1;this.$refs.wfLastNode.showFun(n,(function(){a.$router.go(-1)}))}else if(81e3==i)this.$refs.wfChooseLinks.showFun(n,(function(t){e.push(a.$refs.wfChooseLinks),a.flowSendNextRequest("wfr/sendToLine",{sRequestID:a.requestID,sLineID:t.LineID},e)}));else if(82e3==i)this.$refs.wfChooseUsers.showFun(n,(function(t,n,i){e.push(a.$refs.wfChooseUsers),a.flowSendNextRequest("wfr/sendToReceivers",{sRequestID:a.requestID,sReceivers:t,sOpinion:JSON.stringify({Content:n,Attachments:i})},e)}));else{var o=null;switch(i){case 91e3:o="无后续可发送节点";break;case 92e3:o="无可选的发送对象";break;case 92001:o="该环节只允许发送给一人，但是必选项超过一个";break;case 92002:o="未找到继承环节";break;case 93e3:o="该事项已被处理";break;case 93001:o="保存流转情况信息失败";break;case 93002:o="保存流转环节信息失败";break;case 94001:o="与分支不能设置办结节点";break;case 95001:o="没有可回收的环节";break;case 95002:o="回收环节已接收或已处理，无法回收";break;case 99e3:o="获取数据锁失败";break}dsf.layer.alert({title:"发送中断",message:o||"未知流程类型发送",confirmButtonText:"返回列表页"},(function(){a.$router.go(-1)}))}}},flowSendNextRequest:function(t,e,a){var n=this;this.loading();dsf.http.post(t,e).then((function(t){2e4==t.data.state?n.wFType(t,a):dsf.layer.message("发送异常：".concat(t.data.message))})).catch((function(){dsf.layer.message("".concat(t,"，服务器异常"))}))},getProcessInfo:function(t){var e=this;t||(t=dsf.layer.loading()),dsf.http.get("wfr/getProcessInfoByPID",{sPID:this.sPID}).then((function(t){t.data.success?e.$refs.wfProcess.setData(t.data.data):dsf.layer.message("获取流转情况异常：".concat(t.data.message))})).catch((function(){dsf.layer.message("获取流转情况异常")}))},getSendBackLink:function(){var t=this;this.loading("退回中"),dsf.http.post("wfr/getSendBackLink",{sPID:this.sPID,sCurLinkID:this.sCurLinkID}).then((function(e){if(2e4==e.data.state&&e.data.data.BackLinks){var a=e.data.data.BackLinks;if(1==a.length)t.sendBack(a[0]);else{var n={SendParams:{Lines:[]}};for(var i in a){var s=a[i];n["SendParams"]["Lines"].push(Object(T["a"])({Name:s.NodeName+"-"+s.LinkUser.RUserName},s))}t.$refs.wfChooseLinks.showFun(n,(function(e){t.sendBack(e,t.$refs.wfChooseLinks)}))}}else dsf.layer.message("退回异常：".concat(e.data.message))})).catch((function(t){dsf.layer.message("退回中断，服务器异常")}))},sendBack:function(t,e){var a=this;this.$refs.wfOpinion.showFun(0,(function(n){a.loading("退回中");var i={sPID:a.sPID,sCurLinkID:a.sCurLinkID,sReason:n,sBackLinkID:t.ID};dsf.http.post("wfr/sendBack",i).then((function(n){e&&(e.show=!1),a.$refs.wfOpinion.show=!1,2e4==n.data.state&&n.data.data&&"21000"==n.data.data.Code?dsf.layer.alert({message:"已成功退回到 "+t.NodeName+" 环节"},(function(){a.$router.go(-1)})):dsf.layer.message("".concat(n.data.data.Message||"退回异常"))})).catch((function(t){dsf.layer.message("退回中断，服务器异常")}))}))}}},ct={name:"FlowDemo",mixins:[lt],data:function(){return{itemData:{},showDialog:!1,dialogHolder:"请输入审批意见",shyj_value:"",btnDir:{1:"同意",0:"不同意"},pageTitle:"详情"}},created:function(){this.getDetail()},methods:{getDetail:function(){this.sWFID="test.wf.wf01",this.sPID=dsf.url.queryString("sPID"),this.sCurLinkID=dsf.url.queryString("sCurLinkID"),this.getProcessInfo()},popDialog:function(t){this.btn_type=t,this.dialogHolder=this.btnDir[t],this.showDialog=!0},onConfirm:function(){this.shyj_value||(this.shyj_value=this.dialogHolder);var t=this,e={qjdId:this.itemData.teas_xyxt_qjd_id,shyj:this.shyj_value,type:this.btn_type},a="teas/mobile/qjsq/sp";this.dsf.http.get(a,e).done((function(e){console.log(e),e.success?(t.dsf.layer.message("操作".concat(e.message,"，请稍后再试")),t.$router.go(-1)):t.dsf.layer.message("".concat(e.message,"，请稍后再试"))})).error((function(e){t.dsf.layer.message("审批请求失败，请联系管理员"),console.log("".concat(a," 接口请求失败 错误码:").concat(e))}))},previewFile:function(t){var e=JSON.parse(t)[0],a=e.relativePath;e.id&&this.$router.push({name:"bufferPage",params:{url:a,text:e.originalFileName,id:e.id}})}}},ut=ct,dt=Object(m["a"])(ut,N,O,!1,null,null,null),ft=dt.exports,ht=[{path:"/mobile/flow",component:ft}],pt=ht;b["default"].use(C["a"]);var gt=[].concat(Object(x["a"])(pt),[{path:"*",component:$}]),mt=new C["a"]({mode:"hash",base:"",routes:gt});dsf.init.initRouter(mt,"mobile"),dsf.transition.initRouteTransition(mt);var vt=mt;i.a.configure({easing:"ease-in",minimum:.1,showSpinner:!1}),b["default"].use(s["a"]),b["default"].use(o["a"]),b["default"].use(r["a"]),b["default"].use(l["a"]),dsf.init.injectionDsf(b["default"],dsf),dsf.init.injectionHttp(b["default"],dsf.http),dsf.init.injectionWebAPI(b["default"],c["a"]),b["default"].config.productionTip=!1,window.$$mobile=!0,vt.beforeEach((function(t,e,a){i.a.start(),a()})),vt.afterEach((function(t,e){i.a.done()})),dsf.init.hotLoad(d||[],vt,"mobile").then((function(){new b["default"]({store:y["a"],router:vt,created:function(){dsf.flexble()},render:function(t){return t(w)}}).$mount("#app")}))},"7c47":function(t,e,a){},"82d7":function(t,e,a){"use strict";(function(t){a("99af"),a("4160"),a("a15b"),a("fb6a"),a("ac1f"),a("1276"),a("159b");e["a"]={name:"ChooseUsersDialog",data:function(){return{data:[],show:!1,message:"",loader:null,tpls:[],resolve:function(){},acceptTypes:[".doc,.docx,.xml,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document","image/*"],acceptsType:"",uploaderData:[],previewing:!1,filePath:""}},created:function(){this.getTemplate()},methods:{showFun:function(t,e){if(this.show=!0,this.data=[],t&&t.SendParams&&t.SendParams.Lines&&t.SendParams.Lines.length){var a=t.SendParams.Lines;for(var n in a){var i=a[n];this.data.push({name:i.Name,id:i.LineID,users:[],selects:{},sNum:0}),i.Selected&&this.getUserData(i.Receivers.Dept,null,this.data.length-1)}}console.log(this.data),e&&(this.resolve=e)},getLinkName:function(t){var e=t.split("→");return e[e.length-1]},getUserData:function(t,e,a){for(var n in t.Objs&&(t.ChildDepts=t.ChildDepts.concat(t.Objs)),0!=t.Type&&(1*t.Selected>0&&(this.data[a]["selects"][t.ID]=t,this.data[a]["sNum"]++,t.isSelect=!0),this.data[a]["users"].push(t)),t.ChildDepts)this.getUserData(t.ChildDepts[n],t,a)},getTemplate:function(){var t=this,e=dsf.layer.loading(),a="";dsf.http.get("wfr/getOpinionKeyWord",{}).done((function(e){e.success?t.tpls=e.data||[]:a="获取意见模板，请求异常"})).error((function(t){a="获取意见模板，服务器异常"})).always((function(){dsf.layer.closeLoading(e),a&&dsf.layer.messsgege(a,!1)}))},changeUser:function(t,e,a){1*t.Selected!=2&&(t.isSelect=!t.isSelect,t.isSelect?a["selects"][t.ID]=t:delete a["selects"][t.ID],this.$set(a["users"],e,t))},submit:function(){var t=[],e=0;for(var a in this.data){var n=this.data[a],i="";for(var s in n.selects)i+=(i?",":"")+s;i&&(t[e]=n.id+":"+i,e++)}if(0==e)dsf.layer.messsgege("请选择",!1);else{var o=[];for(var r in this.uploaderData){var l=this.uploaderData[r];o.push(l.data)}this.resolve(t.join(";"),this.message,o)}},uploader:function(t){var e=this;this.acceptsType=this.acceptTypes[t],this.$nextTick((function(){e.$refs.uploader.chooseFile()}))},uploaderAfterRead:function(e){e.length||(e=[e]),t.forEach(e,(function(t){t.status="uploading",t.message="上传中...";var e=!1,a=new FormData;a.append("file",t.file),dsf.http.post("file/upload",a,{headers:{"Content-Type":"multipart/form-data"}}).done((function(a){"20000"==a.state?(t.status="done",t.data=a.data[0]):e=a.message||!0})).error((function(t){e=t.message||!0})).always((function(){e&&(t.status="failed",t.message="上传失败",t._message=e)}))}))},preview:function(t){t&&t.data&&t.data.contentType&&"image"!==t.data.contentType.slice(0,5)&&(this.filePath=dsf.config.webRoot+"preview/file?fileId="+t.data.id,this.previewing=!0)}}}}).call(this,a("2ef0"))},"9ffa":function(t,e,a){"use strict";(function(t){var e=a("f339"),n=t.extend(e["d"]),i=function(e,a){a.value?t.nextTick((function(){var t=dsf.getCss(e,"position");"absolute"!==t&&"relative"!==t&&"fixed"!==t&&(e.style.position="relative"),e.mask.style.display="block",s(e,e,a)})):e.mask.style.display="none"},s=function(t,e){t.appendChild(e.mask)};t.directive("loading",{bind:function(t,e){var a=new n({el:document.createElement("div"),data:{text:t.getAttribute("load-text")||"加载中"}});t.instance=a,t.mask=a.$el,e.value&&i(t,e)},update:function(t,e){e.oldValue!==e.value&&i(t,e)},unbind:function(t,e){t.mask&&t.mask.parentNode&&t.removeChild(t.mask),t.instance&&t.instance.$destroy()}})}).call(this,a("a026")["default"])},b1ac:function(t,e,a){"use strict";a("b0c0"),a("a52c");var n=a("2ed4"),i=(a("537a"),a("ac28")),s=(a("2994"),a("2bdd")),o=(a("ab71"),a("58e6")),r=(a("4d48"),a("d1e1")),l=(a("81e6"),a("9ffb")),c=(a("c3a6"),a("ad06")),u=(a("e930"),a("8f80")),d=(a("5f5f"),a("f253")),f=(a("ac1e"),a("543e")),h=(a("4662"),a("28a2")),p=(a("3df5"),a("2830")),g=(a("4056"),a("44bf")),m=(a("e17f"),a("2241")),v=(a("8a58"),a("e41f")),w=(a("be7f"),a("565f")),y=(a("7c47"),a("9ffa"),a("f339")),x=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ds-control ds-page mobile",class:t.getCss,style:t.pageStyle},[t.hasHeader?a("div",{staticClass:"ds-page-head"},[a("div",{ref:"head",staticClass:"head-inner",attrs:{"slot-name":t.slots[1].name}},[t._t(t.slots[1].name)],2)]):t._e(),a("div",{staticClass:"ds-page-content",style:t.pageContentStyle},[a("div",{staticClass:"ds-page-center",attrs:{"slot-name":t.slots[0].name}},[t._t(t.slots[0].name)],2)]),t.hasFooter?a("div",{staticClass:"ds-page-foot"},[a("div",{ref:"foot",staticClass:"foot-inner",attrs:{"slot-name":t.slots[2].name}},[t._t(t.slots[2].name)],2)]):t._e(),a("div",{staticStyle:{display:"none"},domProps:{innerHTML:t._s(t.customCss)}}),!t.isDesign&&t.gotoIcon?a("a",{directives:[{name:"drag",rawName:"v-drag"}],ref:"eleDesgin",staticClass:"to_desgin",attrs:{"data-flag":"true",title:"进入"+t.title+"设计模式"},on:{click:t.gotoPreview}},[a("i",{staticClass:"iconfont icon-shezhi"})]):t._e()])},b=[],C=a("7958"),D=C["a"],_=a("2877"),k=Object(_["a"])(D,x,b,!1,null,null,null),I=k.exports,S=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ds-control ds-datagrid mobile",staticStyle:{height:"100%"}},[a("div",{staticClass:"ds-datagrid-wrap"},[t.isDesign?[a("div",{staticClass:"ds-datagrid-item"},[t._t("data-item",[a("DsfMobilGridLayout",{attrs:{areas:t.areas,"is-design":t.isDesign,"design-only-slot":!0,"grid-rows":t.layout.heights,"grid-columns":t.layout.widths,"grid-template":t.layout.matrix},scopedSlots:t._u([t._l(t.areas,(function(e){return{key:e.name,fn:function(){return[a("div",{key:e.name,staticClass:"grid-area-content",attrs:{"slot-name":e.name}},[t._t(e.name)],2)]},proxy:!0}}))],null,!0)})])],2),a("div",{directives:[{name:"show",rawName:"v-show",value:t.rangeWrap.show,expression:"rangeWrap.show"}],staticClass:"selected-range",style:{height:t.rangeWrap.height+"px",width:t.rangeWrap.width+"px",top:t.rangeWrap.top+"px",left:t.rangeWrap.left+"px"}})]:[a("van-list",{attrs:{finished:t.finished,"finished-text":t.finishedText},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[a("van-pull-refresh",{staticStyle:{height:"100%"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},t._l(t.value,(function(e,n){return a("div",{key:e._id||t.dsf.uuid(),staticClass:"ds-datagrid-item"},[t._t("data-item",[a("DsfMobilGridLayout",{attrs:{areas:t.areas,"is-design":t.isDesign,"design-only-slot":!0,"grid-rows":t.layout.heights,"grid-columns":t.layout.widths,"grid-template":t.layout.matrix},scopedSlots:t._u([t._l(t.areas,(function(i){return{key:i.name,fn:function(){return[a("div",{key:i.name,staticClass:"grid-area-content center middle",staticStyle:{border:"1px solid red"}},[a("div",{staticClass:"ds-multi-ellipsis-2"},[t._t(i.name,null,null,{row:e,$index:n,_self:t._self})],2)])]},proxy:!0}}))],null,!0)})])],2)})),0)],1)]],2)])},$=[],N=a("c5b0"),O=N["a"],T=Object(_["a"])(O,S,$,!1,null,null,null),j=T.exports,L=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ds-control ds-form-item ds-textbox mobile",class:t.getCss},[t.simple&&t.readOnly&&!t.isDesign?[a("span",[t._v(t._s(t._f("proxy")(t.value,t.formatter)))]),t.errors.length>0?a("div",{staticClass:"ds-error-text"},[t._v(t._s(t.errorsMsg))]):t._e()]:[t.readOnly?t._e():a("van-field",{attrs:{placeholder:t.placeholder,type:t.inputType,disabled:t.disabled,label:t.showLabel&&t.label?t.label:"",required:t.required,"input-align":t.inputAlign},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}),t.readOnly?a("van-field",{attrs:{placeholder:t.placeholder,type:t.inputType,disabled:t.disabled,label:t.showLabel&&t.label?t.label:"","input-align":"left"},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):t._e()]],2)},R=[],P=a("7ef1"),W=dsf.component({name:"DsfMobileTextbox",mixins:[P["a"]],ctrlCaption:"文本框",props:{ishideCon:{type:Boolean,default:!1},placeholder:{type:String,default:"请输入"},metadata:{type:Object,default:function(){return dsf.metadata.get("text-meta-data")}},inputAlign:{type:String,default:"right"}},computed:{inputType:function(){return this.ishideCon?"password":"text"},inputValue:{get:function(){return this.value},set:function(t){this.emitValueChange(t)}}},methods:{}}),H=W,M=Object(_["a"])(H,L,R,!1,null,null,null),A=M.exports,F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-row",{staticClass:"ds-control ds-row mobile  ds-no-drop",attrs:{gutter:"gutter"}},[t._t("default")],2)},E=[],J=(a("a9e3"),a("821f")),q=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-col",{staticClass:"ds-control ds-col ds-no-padding mobile",class:t.getCss,style:t.getStyle,attrs:{"slot-name":"default",span:t.span}},[t._t("default")],2)},V=[],z=dsf.component({name:"DsfMobileCol",mixins:[J["a"]],ctrlCaption:"栅格列",inject:{parentRow:{default:null}},props:{minHeight:{type:String,default:"0"},height:{type:String,default:"auto"},offset:{type:Number,default:null},slots:{type:Array,default:function(){return[{name:"default",controls:[]}]}},span:{type:Number,default:24}},computed:{getStyle:function(){var t=/(px|em|rem|vh|vw|%)$/g,e=this.height;"number"==dsf.type(this.height)&&(e=this.height+"px"),"auto"==e||t.test(e)||(e=this.height+"px",t.lastIndex=0);var a={height:e};return this.isDesign||this.parentRow.minHeight&&(a["min-height"]=this.parentRow.minHeight+"px"),a}},data:function(){return{}},created:function(){},mounted:function(){}}),B=z,U=Object(_["a"])(B,q,V,!1,null,null,null),K=U.exports,G=dsf.component({name:"DsfMobileRow",mixins:[J["a"]],ctrlCaption:"栅格布局",props:{gutter:{type:Number,default:0},minHeight:{type:String,default:"0"},height:{type:String,default:"auto"},slots:{type:Array,default:function(){return[{name:"default",controls:[]}]}}},provide:function(){return{parentRow:this}},data:function(){return{}},computed:{rowHeight:function(){if(this.isDesign)return"100%";var t=this.height;return dsf.isNumber(t)&&(t+="px"),t}},created:function(){},mounted:function(){X.call(this)},watch:{height:{handler:function(t){if(this.isDesign){var e=t;t||(e="auto"),dsf.isNumber(e)&&(e+="px"),this.$dispatch("design-height-change",e)}},immediate:!0}}});function X(){if(this.isDesign&&0==this.slots[0].controls.length)for(var t=2,e=0;e<t;e++){var a=24/t,n={height:"auto",span:a};this.slots[0].controls.push(dsf.designer.createComponent(K,n))}}var Y=G,Q=Object(_["a"])(Y,F,E,!1,null,null,null),Z=Q.exports,tt=(a("e7e5"),a("d399")),et={openDialog:function(){},message:function(t,e){if(dsf.isUnDef(e))Object(tt["a"])(t);else{var a={message:""};"string"==dsf.type(t)&&(a.message=t),!1!==e?tt["a"].success(a.message):tt["a"].fail(a.message)}},alert:function(t){return"string"==dsf.type(t)&&(t={message:t}),m["a"].alert(t)},confirm:function(t){return"string"==dsf.type(t)&&(t={message:t}),m["a"].confirm(t)}};function at(t){t.use(w["a"]),t.use(v["a"]),t.use(m["a"]),t.use(g["a"]),t.use(p["a"]),t.use(h["a"]),t.use(f["a"]),t.use(d["a"]),t.use(u["a"]),t.use(c["a"]),t.use(l["a"]),t.use(r["a"]),t.use(o["a"]),t.use(s["a"]),t.use(i["a"]),t.use(n["a"]),t.component(I.name,I),t.component(Z.name,Z),t.component(K.name,K),t.component(A.name,A),t.component(j.name,j),t.component(y["d"].name,y["d"]),t.component(y["c"].name,y["c"]),t.component(y["b"].name,y["b"]),t.component(y["a"].name,y["a"])}dsf.mix(dsf.layer,{mobile:et}),"undefined"!==typeof window&&window.Vue&&at(window.Vue);e["a"]={install:at}},c5b0:function(t,e,a){"use strict";(function(t,n){a("99af"),a("cb29"),a("c740"),a("4160"),a("c975"),a("a15b"),a("d81d"),a("fb6a"),a("a434"),a("b0c0"),a("a9e3"),a("b680"),a("07ac"),a("159b"),a("4795");var i=a("2909"),s=a("821f"),o=a("1734");function r(t){if(this.isDesign&&t&&t.length){var e=[],a=[],n=[],s=[],o=t.map((function(t){var i=t.position();e.push(i.top),a.push(i.left),n.push(i.top+t.height()),s.push(i.left+t.width());var o=+t.attr("grid-index");return{name:"grid-area-"+o,gridIndex:o,rowIndex:+t.attr("row-index"),colIndex:+t.attr("col-index")}}));e=Math.min.apply(Math,Object(i["a"])(e)),a=Math.min.apply(Math,Object(i["a"])(a)),n=Math.max.apply(Math,Object(i["a"])(n)),s=Math.max.apply(Math,Object(i["a"])(s)),this.rangeWrap={show:!0,width:s-a,height:n-e-1,top:e-4,left:a-4,selected:o}}}function l(t,e){if(e&&t.get(0)!=e.get(0)){var a=c.call(this,t,e),i=a.minRowIndex,s=a.maxRowIndex,o=a.minColIndex,r=a.maxColIndex;return u.call(this,i,s,o,r)}return[n(t)]}function c(t,e){var a=+e.attr("row-index"),n=+e.attr("col-index"),i=+e.attr("rowspan")-1,s=+e.attr("colspan")-1,o=+t.attr("row-index"),r=+t.attr("col-index"),l=+t.attr("rowspan")-1,c=+t.attr("colspan")-1,u=Math.min(o,a),f=Math.max(o+l,a+i),h=Math.min(r,n),p=Math.max(r+c,n+s);return d.call(this,u,f,h,p)}function u(t,e,a,n){for(var i=[],s=t;s<=e;s++)for(var o=a;o<=n;o++){var r=f.call(this,s,o);r&&i.push(r)}return i}function d(t,e,a,n){var i=u.call(this,t,e,a,n),s=[],o=[],r=[],l=[];i.forEach((function(t){r.push(+t.attr("row-index")),l.push(+t.attr("col-index")),s.push(+t.attr("row-index")+ +t.attr("rowspan")-1),o.push(+t.attr("col-index")+ +t.attr("colspan")-1)}));var c=Math.min.apply(Math,r),f=Math.max.apply(Math,s),h=Math.min.apply(Math,l),p=Math.max.apply(Math,o);return c==t&&f==e&&h==a&&p==n?{minRowIndex:c,maxRowIndex:f,minColIndex:h,maxColIndex:p}:d.call(this,c,f,h,p)}function f(t,e){var a=this.$refs.gridAreas;if(!a||!a.length)return null;for(var i="grid-area-"+this.layout.matrix[t][e],s=0;s<a.length;s++)if(n(a[s]).hasClass(i))return n(a[s]);return null}function h(t){var e=this,a=[];return t.forEach((function(t){var n=t.rowIndex,i=t.colIndex,s=f.call(e,n,i);s&&a.push(s)})),a}function p(){this.downCell=null,this.rangeWrap={show:!1,width:0,height:0,top:-10,left:-10,selected:[]}}function g(t){for(var e=0;e<t.length;e++){var a=t.eq(e);a.hasClass("grid-area")||(a=a.closest(".grid-area"));var n=a.closest(".ds-datagrid");if(this.$el===n.get(0))return a}return null}function m(t,e,a,n){for(var i=this,s=JSON.parse(JSON.stringify(this.layout)),o=s.matrix[t][a],l=t;l<=e;l++)for(var c=a;c<=n;c++)s.matrix[l][c]=o;this.$emit("update:layout",s),this.$nextTick((function(){var t=h.call(i,i.rangeWrap.selected);r.call(i,t)}))}function v(t){var e=[];return t.forEach((function(t){var a=t.get?t:n(t),i=+a.attr("rowspan"),s=+a.attr("colspan");(i>1||s>1)&&e.push(a)})),e}function w(t){var e=this,a=JSON.parse(JSON.stringify(this.layout));t.forEach((function(t){for(var e=+t.attr("row-index"),n=+t.attr("col-index"),i=+t.attr("colspan")-1,s=+t.attr("rowspan")-1,o=e,r=e+s;o<=r;o++)for(var l=n,c=n+i;l<=c;l++)a.matrix[o][l]=o*a.widths.length+l+1})),this.$emit("update:layout",a),this.$nextTick((function(){var t=h.call(e,e.rangeWrap.selected);r.call(e,t)}))}function y(t,e){return Array(t).fill(1).map((function(t,a){return Array(e).fill(1).map((function(t,n){return n+1+a*e}))}))}function x(t){var e=this,a=JSON.parse(JSON.stringify(this.layout)),n=y(a.matrix.length+1,a.widths.length);v(this.$refs.gridAreas).forEach((function(e){var i,s=+e.attr("row-index"),o=+e.attr("row-index")+ +e.attr("rowspan")-1,r=+e.attr("col-index"),l=+e.attr("col-index")+ +e.attr("colspan")-1;t<=o&&t>s?(o++,i=s*a.widths.length+r+1):(t>o||(s++,o++),i=s*a.widths.length+r+1);for(var c=s;c<=o;c++)for(var u=r;u<=l;u++)n[c][u]=i})),a.matrix=n,a.heights.splice(t,0,"46px"),this.$emit("update:layout",a),this.$nextTick((function(){var a=h.call(e,e.rangeWrap.selected.map((function(e){return t>e.rowIndex?e:{rowIndex:e.rowIndex+1,colIndex:e.colIndex}})));r.call(e,a)}))}function b(t){var e=this,a=JSON.parse(JSON.stringify(this.layout)),n=y(a.matrix.length,a.widths.length+1);v(this.$refs.gridAreas).forEach((function(e){var i,s=+e.attr("row-index"),o=+e.attr("row-index")+ +e.attr("rowspan")-1,r=+e.attr("col-index"),l=+e.attr("col-index")+ +e.attr("colspan")-1;t<=l&&t>r?(i=s*(a.widths.length+1)+r+1,l++):(t>l||(r++,l++),i=s*(a.widths.length+1)+r+1);for(var c=s;c<=o;c++)for(var u=r;u<=l;u++)n[c][u]=i})),a.matrix=n,a.widths=new Array(n[0].length).fill(dsf.pxToRem(+(100/(a.widths.length+1)).toFixed(3)+"%")),this.$emit("update:layout",a),this.$nextTick((function(){var a=h.call(e,e.rangeWrap.selected.map((function(e){return t>e.colIndex?e:{rowIndex:e.rowIndex,colIndex:e.colIndex+1}})));r.call(e,a)}))}function C(){var t=h.call(this,this.rangeWrap.selected),e=t[0],a=t[t.length-1],n=+a.attr("row-index"),i=+a.attr("col-index"),s=+a.attr("rowspan"),o=+a.attr("colspan"),r=+e.attr("row-index"),l=+e.attr("col-index");m.call(this,r,n+s-1,l,i+o-1)}function D(){var t=h.call(this,this.rangeWrap.selected),e=v.call(this,t);w.call(this,e)}function _(){var t=h.call(this,this.rangeWrap.selected),e=t[0],a=+e.attr("row-index");x.call(this,a)}function k(){var t=h.call(this,this.rangeWrap.selected),e=t[t.length-1],a=+e.attr("row-index")+ +e.attr("rowspan");x.call(this,a)}function I(){var t=h.call(this,this.rangeWrap.selected),e=t[0],a=+e.attr("col-index");b.call(this,a)}function S(){var t=h.call(this,this.rangeWrap.selected),e=t[t.length-1],a=+e.attr("col-index")+ +e.attr("colspan");b.call(this,a)}function $(){var t=h.call(this,this.rangeWrap.selected),e=t[0],a=t[t.length-1],n=+e.attr("row-index"),i=+a.attr("row-index")+ +a.attr("rowspan")-1,s=i-n+1,o=JSON.parse(JSON.stringify(this.layout));o.matrix.splice(n,s),o.heights.splice(n,s),this.$emit("update:layout",o)}function N(){var t=h.call(this,this.rangeWrap.selected),e=t[0],a=t[t.length-1],n=+e.attr("col-index"),i=+a.attr("col-index")+ +a.attr("colspan")-1,s=i-n+1,o=JSON.parse(JSON.stringify(this.layout));this.layout.matrix.forEach((function(t,e){o.matrix[e].splice(n,s)})),o.widths=new Array(o.matrix[0].length).fill(dsf.pxToRem(+(100/o.matrix[0].length).toFixed(3)+"%")),this.$emit("update:layout",o)}function O(){var t=this,e=JSON.parse(JSON.stringify(this.layout));e.widths=new Array(e.widths.length).fill(dsf.pxToRem(+(100/e.widths.length).toFixed(3)+"%")),this.$emit("update:layout",e),this.$nextTick((function(){var e=h.call(t,t.rangeWrap.selected);r.call(t,e)}))}function T(){var t=this,e=JSON.parse(JSON.stringify(this.layout));e.heights=new Array(e.heights.length).fill("46px"),this.$emit("update:layout",e),this.$nextTick((function(){var e=h.call(t,t.rangeWrap.selected);r.call(t,e)}))}e["a"]=dsf.component({name:"DsfMobileDataGrid",ctrlCaption:"数据列表",mixins:[s["a"]],components:{DsfMobilGridLayout:o["a"]},data:function(){return{rangeWrap:{show:!1,width:0,height:0,top:0,left:0,selected:[]},loading:!1,finished:!1,refreshing:!1}},props:{itemHeight:{type:Number,default:60},value:{type:Array,default:function(){return[]}},finishedText:{type:String,default:"没有更多了"},searchInfo:{type:Array,default:function(){return[]}},slots:{type:Array,default:function(){return[{name:"default",controls:[]},{name:"data-item",controls:[],scope:"scope",dataKey:"row",repeat:!0}]}},layout:{type:Object,default:function(){return{matrix:[[1,2,3],[5,6,7],[9,10,11]],widths:["33.3333%","33.3333%","33.3333%"],heights:["46px","46px","46px"]}}}},computed:{areas:function(){var e=this.layout,a={};return t.each(e.matrix,(function(n,i){t.each(n,(function(t,s){var o="grid-area-"+t;a[o]?(s>0&&a[o].endColIndex<s&&n[s-1]==t&&(a[o].colspan++,a[o].endColIndex++),i>0&&a[o].endColIndex==s&&a[o].endRowIndex<i&&e.matrix[i-1][s]==t&&(a[o].rowspan++,a[o].endRowIndex++)):a[o]={name:o,index:t,colspan:1,rowspan:1,startColIndex:s,startRowIndex:i,endColIndex:s,endRowIndex:i}}))})),Object.values(a)}},created:function(){if(!this.isDesign)for(var t=0;t<10;t++)this.value.push({_id:"row"+t,"_.textbox2":"我我能我我能我我能我我能我我能我我能我我能我我能我我能我我能"})},mounted:function(){},methods:{onLoad:function(){this.finished=!0},onRefresh:function(){var t=this;this.value.length>100&&this.value.splice(99,this.value.length),window.setTimeout((function(){t.refreshing=!1}),2e3)}},watch:{areas:{handler:function(e){var a=this,n=t.keyBy(this.slots,(function(t){return t.name}));dsf.array.removeWith(this.slots,(function(t){return 0==t.name.indexOf("grid-area-")})),t.each(this.areas,(function(t){var e={name:t.name,controls:[],scope:"scope",dataKey:"row",unique:"_id",repeat:!0,textProxy:!0},i=n[e.name];e.controls=i?i.controls:[],a.slots.push(e)}))},immediate:!0}},design:{isMask:!1,metadata:{isDeep:!1,create:function(e){var a,n,i=this,s=[];dsf.designer.recursionLayoutTree(this,null,null,(function(t){if(t!=i){var a=t.$options.design||{},n=a.metadata||{},o=n.create&&n.create.call(t,e);if(o&&o.metadata){s.push(o);var r=!dsf.isDef(n.isDeep)||n.isDeep;if(!r)return!1}}}));for(var o={},r=[],l=[],c=0;c<this.searchInfo.length;c++){var u=this.searchInfo[c],d=null;"0"==u.type?(d={code:u.code,operator:u.operation,valueKey:"searchValue"},r.push(d)):(d={code:u.code,operator:u.operation,valueKey:u.code},l.push(d),u.metadata_fullcode=d.code)}var f={logic:"or",items:[]};(a=f.items).push.apply(a,r);var h={logic:"and",items:[]};(n=h.items).push.apply(n,l);var p={logic:"and",items:[]};p.items.push(f),p.items.push(h);var g={logic:"and",items:[]};t.each(this.superSearchInfo,(function(e){var a=null,n="",i=null;if("enum"==e.searchType){var s,o=[];if((null===e||void 0===e||null===(s=e.children)||void 0===s?void 0:s.length)>0?(o=t.map(e.children,(function(t){return 1==t.join})),o=o.slice(0,1)):o=[e],1==o.length){a=o[0].field,n=o[0].operator,i=o[0].field,"in"!=n&&"eq"!=n||(n="in");var r={code:a,operator:"in"==n||"eq"==n?"in":n,valueKey:a};g.items.push(r)}}else if("text"==e.searchType)a=e.code,n=e.operator,i=e.code,g.items.push({code:a,operator:n,valueKey:i});else if("datetime"==e.searchType){var l,c=[];(null===e||void 0===e||null===(l=e.children)||void 0===l?void 0:l.length)>0?(c=t.map(e.children,(function(t){return 1==t.join})),c=c.slice(0,1)):c=[e],1==c.length&&g.items.push({code:c[0].field,operator:c[0].operator,valueKey:c[0].field,dataType:"datetime"})}})),p.items.push(g),o=p;var m={query:o,browseScope:this.browseScope,_self:this};return[m].concat(s)}},contextMenuHandler:function(e){var a=g.call(this,n(e.target));if(a&&a.length){var i=t.findIndex(this.rangeWrap.selected,(function(t){return t.gridIndex==a.attr("grid-index")}));if(i<0){this.downCell=a;var s=l.call(this,this.downCell,null);r.call(this,s)}return[{text:"合并单元格",hide:!0,handler:C},{text:"拆分单元格",disabled:!1,handler:D},"-",{text:"插入行(前)",disabled:!1,handler:_},{text:"插入行(后)",disabled:!1,handler:k},{text:"插入列(前)",disabled:!1,handler:I},{text:"插入列(后)",disabled:!1,handler:S},"-",{text:"删除整行",disabled:!1,handler:$},{text:"删除整列",disabled:!1,handler:N},"-",{text:"重置列宽",disabled:!1,handler:O},{text:"重置行高",disabled:!1,handler:T}]}},clearContextMemuHandler:function(){this.isDown=!1,p.call(this)},clearMouseDownHandler:function(){this.isDown=!1,p.call(this)},mouseDownHandler:function(t){if(this.isDesign&&0===t.button){this.isDown=!0,this.downCell=g.call(this,n(t.target));var e=l.call(this,this.downCell,null);r.call(this,e),t.stopPropagation()}},mouseMoveHandler:function(t){if(this.isDown){var e=g.call(this,n(t.target));if(e){var a=l.call(this,this.downCell,e);r.call(this,a),t.stopPropagation()}}},mouseUpHandler:function(){this.isDown=!1}}})}).call(this,a("2ef0"),a("1157"))},d318:function(t,e,a){},f339:function(t,e,a){"use strict";a.d(e,"d",(function(){return c})),a.d(e,"c",(function(){return g})),a.d(e,"b",(function(){return b})),a.d(e,"a",(function(){return S}));var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ds-loading"},[a("van-loading",{staticStyle:{height:"100%"},attrs:{vertical:""}},[t._v(t._s(t.text))])],1)},i=[],s={name:"DsfMobileLoading",components:{},data:function(){return{text:"加载中"}},computed:{},created:function(){},mounted:function(){},methods:{}},o=s,r=a("2877"),l=Object(r["a"])(o,n,i,!1,null,null,null),c=l.exports,u=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"full-view"},[t._t("default")],2)},d=[],f={name:"DsfMobileEmptyView"},h=f,p=Object(r["a"])(h,u,d,!1,null,null,null),g=p.exports,m=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("van-tabbar",{staticClass:"ds-bottom-nav ds_control",attrs:{fixed:!1,"safe-area-inset-bottom":!0},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},t._l(t.buttons,(function(e,n){return a("van-tabbar-item",{key:n,attrs:{name:n},on:{click:function(a){return a.stopPropagation(),t.go(e.url)}}},[a("span",[t._v(t._s(e.text))]),t.active==n?[e.icon.active?a("dsf-icon",{attrs:{slot:"icon",name:e.icon.active?e.icon.active:"yiwen"},slot:"icon"}):e.icon.general?a("dsf-icon",{attrs:{slot:"icon",name:e.icon.general?e.icon.general:"yiwen"},slot:"icon"}):t._e()]:[e.icon.general?a("dsf-icon",{attrs:{slot:"icon",name:e.icon.general?e.icon.general:"yiwen"},slot:"icon"}):t._e()]],2)})),1)},v=[],w=a("482c"),y=w["a"],x=Object(r["a"])(y,m,v,!1,null,null,null),b=x.exports,C=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("i",{staticClass:"iconfont",class:[t.name?"icon-"+t.name:""]})},D=[],_={name:"DsfIcon",props:{name:{type:String,default:function(){return""}}}},k=_,I=Object(r["a"])(k,C,D,!1,null,null,null),S=I.exports}}]);
//# sourceMappingURL=dsf-mobile.js.map